<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Frey's blog - 文件</title><link href="https://vhcffh.com/" rel="alternate"></link><link href="https://vhcffh.com/feeds/wen-jian.atom.xml" rel="self"></link><id>https://vhcffh.com/</id><updated>2018-09-09T12:00:00+08:00</updated><entry><title>图片头文件解析</title><link href="https://vhcffh.com/tu-pian-tou-wen-jian-jie-xi.html" rel="alternate"></link><published>2017-12-12T10:01:00+08:00</published><updated>2018-09-09T12:00:00+08:00</updated><author><name>Frey</name></author><id>tag:vhcffh.com,2017-12-12:/tu-pian-tou-wen-jian-jie-xi.html</id><summary type="html">&lt;p&gt;各种类型的图片头文件解析&lt;/p&gt;</summary><content type="html">&lt;h1&gt;1.PNG图片文件头&lt;/h1&gt;
&lt;h2&gt;1.1PNG文件结构&lt;/h2&gt;
&lt;p&gt;PNG图像格式文件由一个8字节的PNG文件标识（file signature）域和3个以上的后续数据块（IHDR、IDAT、IEND等）组成。&lt;br&gt;
PNG文件包括8字节文件署名（89 50 4E 47 0D 0A 1A 0A，十六进制），用来识别PNG格式。  &lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="center"&gt;十六进制&lt;/th&gt;
&lt;th align="left"&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="center"&gt;89&lt;/td&gt;
&lt;td align="left"&gt;用于检测传输系统是否支持8位的字符编码（8 bit data），用以减少将文本文件被错误的识别成PNG文件的机会，反之亦然。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;50 4E 47&lt;/td&gt;
&lt;td align="left"&gt;PNG每个字母对应的ASCII，让用户可以使用文本编辑器查看时，识别出是PNG文件。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;0D 0A&lt;/td&gt;
&lt;td align="left"&gt;DOS风格的换行符（CRLF）。用于DOS-Unix数据的换行符转换。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;1A&lt;/td&gt;
&lt;td align="left"&gt;在DOS命令行下，用于阻止文件显示的文件结束符。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;0A&lt;/td&gt;
&lt;td align="left"&gt;Unix风格的换行符（LF）。用于Unix-DOS换行符的转换。&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2&gt;1.2PNG数据块（chunk）&lt;/h2&gt;
&lt;p&gt;PNG定义了两种类型的数据块，一种是称为关键数据块(critical chunk)，这是标准的数据块，另一种叫做辅助数据块(ancillary chunks)，这是可选的数据块。&lt;br&gt;
关键数据块定义了4个标准数据块，每个PNG文件都必须包含它们，PNG读写软件也都必须要支持这些数据块。虽然PNG文件规范没有要求PNG编译码器对可选数据块进行编码和译码，但规范提倡支持可选数据块。&lt;br&gt;
下表就是PNG中数据块的类别，其中，关键数据块部分我们使用红色背景加以区分。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="center"&gt;数据块符号&lt;/th&gt;
&lt;th align="center"&gt;数据块名称&lt;/th&gt;
&lt;th align="center"&gt;多数据块&lt;/th&gt;
&lt;th align="center"&gt;可选否&lt;/th&gt;
&lt;th align="center"&gt;位置限制&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="center"&gt;IHDR&lt;/td&gt;
&lt;td align="center"&gt;文件头数据块&lt;/td&gt;
&lt;td align="center"&gt;否&lt;/td&gt;
&lt;td align="center"&gt;否&lt;/td&gt;
&lt;td align="center"&gt;第一块&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;cHRM&lt;/td&gt;
&lt;td align="center"&gt;基色和白色点数据块&lt;/td&gt;
&lt;td align="center"&gt;否&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;在PLTE和IDAT之前&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;gAMA&lt;/td&gt;
&lt;td align="center"&gt;图像γ数据块&lt;/td&gt;
&lt;td align="center"&gt;否&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;在PLTE和IDAT之前&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;sBIT&lt;/td&gt;
&lt;td align="center"&gt;样本有效位数据块&lt;/td&gt;
&lt;td align="center"&gt;否&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;在PLTE和IDAT之前&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;PLTE&lt;/td&gt;
&lt;td align="center"&gt;调色板数据块&lt;/td&gt;
&lt;td align="center"&gt;否&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;在IDAT之前&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;bKGD&lt;/td&gt;
&lt;td align="center"&gt;背景颜色数据块&lt;/td&gt;
&lt;td align="center"&gt;否&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;在PLTE之后IDAT之前&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;hIST&lt;/td&gt;
&lt;td align="center"&gt;图像直方图数据块&lt;/td&gt;
&lt;td align="center"&gt;否&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;在PLTE之后IDAT之前&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;tRNS&lt;/td&gt;
&lt;td align="center"&gt;图像透明数据块&lt;/td&gt;
&lt;td align="center"&gt;否&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;在PLTE之后IDAT之前&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;oFFs&lt;/td&gt;
&lt;td align="center"&gt;(专用公共数据块)&lt;/td&gt;
&lt;td align="center"&gt;否&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;在IDAT之前&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;pHYs&lt;/td&gt;
&lt;td align="center"&gt;物理像素尺寸数据块&lt;/td&gt;
&lt;td align="center"&gt;否&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;在IDAT之前&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;sCAL&lt;/td&gt;
&lt;td align="center"&gt;(专用公共数据块)&lt;/td&gt;
&lt;td align="center"&gt;否&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;在IDAT之前&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;IDAT&lt;/td&gt;
&lt;td align="center"&gt;图像数据块&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;否&lt;/td&gt;
&lt;td align="center"&gt;与其他IDAT连续&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;tIME&lt;/td&gt;
&lt;td align="center"&gt;图像最后修改时间数据块&lt;/td&gt;
&lt;td align="center"&gt;否&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;无限制&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;tEXt&lt;/td&gt;
&lt;td align="center"&gt;文本信息数据块&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;无限制&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;zTXt&lt;/td&gt;
&lt;td align="center"&gt;压缩文本数据块&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;无限制&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;fRAc&lt;/td&gt;
&lt;td align="center"&gt;(专用公共数据块)&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;无限制&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;gIFg&lt;/td&gt;
&lt;td align="center"&gt;(专用公共数据块)&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;无限制&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;gIFt&lt;/td&gt;
&lt;td align="center"&gt;(专用公共数据块)&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;无限制&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;gIFx&lt;/td&gt;
&lt;td align="center"&gt;(专用公共数据块)&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;是&lt;/td&gt;
&lt;td align="center"&gt;无限制&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;IEND&lt;/td&gt;
&lt;td align="center"&gt;图像结束数据&lt;/td&gt;
&lt;td align="center"&gt;否&lt;/td&gt;
&lt;td align="center"&gt;否&lt;/td&gt;
&lt;td align="center"&gt;最后一个数据块&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;</content><category term="文件头"></category><category term="图片"></category></entry></feed>