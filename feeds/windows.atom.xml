<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Frey's blog - Windows</title><link href="https://summeriwinter.github.io/" rel="alternate"></link><link href="https://summeriwinter.github.io/feeds/windows.atom.xml" rel="self"></link><id>https://summeriwinter.github.io/</id><updated>2018-09-09T12:00:00+08:00</updated><entry><title>windows系统盘瘦身</title><link href="https://summeriwinter.github.io/windowsxi-tong-pan-shou-shen.html" rel="alternate"></link><published>2017-09-02T10:01:00+08:00</published><updated>2018-09-09T12:00:00+08:00</updated><author><name>Frey</name></author><id>tag:summeriwinter.github.io,2017-09-02:/windowsxi-tong-pan-shou-shen.html</id><summary type="html">&lt;p&gt;C盘满了，瘦一下身&lt;/p&gt;</summary><content type="html">&lt;h1&gt;1.关闭系统休眠功能&lt;/h1&gt;
&lt;p&gt;删除Hiberfil.sys文件&lt;br&gt;
管理员运行cmd输入下面命令&lt;br&gt;
&lt;code&gt;powercfg -h of&lt;/code&gt;&lt;/p&gt;
&lt;h1&gt;2.设置虚拟内存&lt;/h1&gt;
&lt;p&gt;控制面板—&amp;gt;(系统和安全)—&amp;gt;系统—&amp;gt;高级系统设置—&amp;gt;(高级)—&amp;gt;设置—&amp;gt;(高级)—&amp;gt;更改&lt;br&gt;
把虚拟内存设置到其它盘  &lt;/p&gt;
&lt;h1&gt;3.删除临时文件&lt;/h1&gt;
&lt;p&gt;以下三个目录里的文件是临时文件，可以删除&lt;br&gt;
C:\windows\temp&lt;br&gt;
C:\ProgramData\TEMP&lt;br&gt;
C:\Users\你的用户名\AppData\Local\Temp  &lt;/p&gt;</content><category term="windwos"></category></entry><entry><title>powershell脚本遍历目录</title><link href="https://summeriwinter.github.io/powershelljiao-ben-bian-li-mu-lu.html" rel="alternate"></link><published>2017-09-01T10:01:00+08:00</published><updated>2018-09-09T12:00:00+08:00</updated><author><name>Frey</name></author><id>tag:summeriwinter.github.io,2017-09-01:/powershelljiao-ben-bian-li-mu-lu.html</id><summary type="html">&lt;p&gt;powershell脚本遍历目录&lt;/p&gt;</summary><content type="html">&lt;h1&gt;1.遍历目录及子目录,显示目录大小&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;function&lt;/span&gt; filesize &lt;span class="o"&gt;([&lt;/span&gt;string&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="nv"&gt;$filepath&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$filepath&lt;/span&gt; -eq &lt;span class="nv"&gt;$null&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        throw &lt;span class="s2"&gt;&amp;quot;路径不能为空&amp;quot;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
    dir -Path &lt;span class="nv"&gt;$filepath&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; ForEach-Object -Process &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$_&lt;/span&gt;.psiscontainer -eq &lt;span class="nv"&gt;$true&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="nv"&gt;$length&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;
            dir -Path &lt;span class="nv"&gt;$_&lt;/span&gt;.fullname -Recurse &lt;span class="p"&gt;|&lt;/span&gt; ForEach-Object &lt;span class="o"&gt;{&lt;/span&gt;
                &lt;span class="nv"&gt;$length&lt;/span&gt; +&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$_&lt;/span&gt;.Length
            &lt;span class="o"&gt;}&lt;/span&gt;
            &lt;span class="nv"&gt;$l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$length&lt;/span&gt; / 1KB
            &lt;span class="nv"&gt;$_&lt;/span&gt;.name + &lt;span class="s2"&gt;&amp;quot;文件夹的大小为: {0:n1} KB&amp;quot;&lt;/span&gt; -f &lt;span class="nv"&gt;$l&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
filesize -filepath &lt;span class="s2"&gt;&amp;quot;D:\&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;2.运行示例:&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;PS F:\python&amp;gt; function filesize ([string]$filepath) {
&amp;gt;&amp;gt; if ($filepath -eq $null) {
&amp;gt;&amp;gt; throw &amp;quot;路径不能为空&amp;quot;
&amp;gt;&amp;gt; }
&amp;gt;&amp;gt; dir -Path $filepath | ForEach-Object -Process {
&amp;gt;&amp;gt; if ($_.psiscontainer -eq $true) {
&amp;gt;&amp;gt; $length = 0
&amp;gt;&amp;gt; dir -Path $_.fullname -Recurse | ForEach-Object {
&amp;gt;&amp;gt; $length += $_.Length
&amp;gt;&amp;gt; }
&amp;gt;&amp;gt; $l = $length / 1KB
&amp;gt;&amp;gt; $_.name + &amp;quot;文件夹的大小为: {0:n1} KB&amp;quot; -f $l
&amp;gt;&amp;gt; }
&amp;gt;&amp;gt; }
&amp;gt;&amp;gt; }
PS F:\python&amp;gt; filesize -filepath &amp;quot;f:\python&amp;quot;
ipluyou文件夹的大小为: 82,196.5 KB
loginip_jlu文件夹的大小为: 16.8 KB
嗅事百科文件夹的大小为: 4.3 KB
小说文件夹的大小为: 31,043.6 KB
笑料文件夹的大小为: 1,578,575.8 KB
PS F:\python&amp;gt;
&lt;/pre&gt;&lt;/div&gt;</content><category term="windwos"></category><category term="powershell"></category></entry><entry><title>powershell卸载自带应用</title><link href="https://summeriwinter.github.io/powershellxie-zai-zi-dai-ying-yong.html" rel="alternate"></link><published>2017-09-01T10:01:00+08:00</published><updated>2018-09-09T12:00:00+08:00</updated><author><name>Frey</name></author><id>tag:summeriwinter.github.io,2017-09-01:/powershellxie-zai-zi-dai-ying-yong.html</id><summary type="html">&lt;p&gt;通过powershell卸载windows自带应用&lt;/p&gt;</summary><content type="html">&lt;h1&gt;1.卸载全部自带应用&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;Get-AppxPackage -User $env:USERNAME | Remove-AppxPackage&lt;/code&gt;  &lt;/p&gt;
&lt;h1&gt;2.其他更多卸载&lt;/h1&gt;
&lt;p&gt;OneNote:&lt;br&gt;
&lt;code&gt;Get-AppxPackage OneNote | Remove-AppxPackage&lt;/code&gt;&lt;br&gt;
3D:&lt;br&gt;
&lt;code&gt;Get-AppxPackage 3d | Remove-AppxPackage&lt;/code&gt;&lt;br&gt;
Camera相机:&lt;br&gt;
&lt;code&gt;Get-AppxPackage camera | Remove-AppxPackage&lt;/code&gt;&lt;br&gt;
邮件和日历:&lt;br&gt;
&lt;code&gt;Get-AppxPackage communi | Remove-AppxPackage&lt;/code&gt;&lt;br&gt;
新闻订阅:&lt;br&gt;
&lt;code&gt;Get-AppxPackage bing | Remove-AppxPackage&lt;/code&gt;&lt;br&gt;
Groove音乐电影与电视:&lt;br&gt;
&lt;code&gt;Get-AppxPackage zune | Remove-AppxPackage&lt;/code&gt;&lt;br&gt;
人脉:&lt;br&gt;
&lt;code&gt;Get-AppxPackage people | Remove-AppxPackage&lt;/code&gt;&lt;br&gt;
手机伴侣Phone Companion:&lt;br&gt;
&lt;code&gt;Get-AppxPackage phone | Remove-AppxPackage&lt;/code&gt;&lt;br&gt;
照片:&lt;br&gt;
&lt;code&gt;Get-AppxPackage photo | Remove-AppxPackage&lt;/code&gt;&lt;br&gt;
纸牌游戏(还敢要钱的那货):&lt;br&gt;
&lt;code&gt;Get-AppxPackage solit | Remove-AppxPackage&lt;/code&gt;&lt;br&gt;
录音机:&lt;br&gt;
&lt;code&gt;Get-AppxPackage soundrec | Remove-AppxPackage&lt;/code&gt;&lt;br&gt;
Xbox:&lt;br&gt;
&lt;code&gt;Get-AppxPackage xbox | Remove-AppxPackage&lt;/code&gt;  &lt;/p&gt;</content><category term="windwos"></category><category term="powershell"></category></entry><entry><title>批处理for循环使用</title><link href="https://summeriwinter.github.io/pi-chu-li-forxun-huan-shi-yong.html" rel="alternate"></link><published>2017-04-22T10:01:00+08:00</published><updated>2017-04-22T12:30:00+08:00</updated><author><name>Frey</name></author><id>tag:summeriwinter.github.io,2017-04-22:/pi-chu-li-forxun-huan-shi-yong.html</id><summary type="html">&lt;p&gt;windows批处理FOR循环的使用&lt;/p&gt;</summary><content type="html">&lt;p&gt;在cmd中输入使用时应写为&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;FOR %variable IN (set) DO command [command-parameters]
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;command [command-parameters]中用到变量也要写为%variable
写进.bat或者.cmd文件时应写为&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;FOR %%variable IN (set) DO command [command-parameters]
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;command [command-parameters]中用到变量也要写为%%variable
Windows自带的help解释:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;FOR %variable IN (set) DO command [command-parameters]

    ::%variable  指定一个单一字母可替换的参数。
    ::(set)      指定一个或一组文件。可以使用通配符。
    ::command    指定对每个文件执行的命令。
    ::command-parameters  为特定命令指定参数或命令行开关。
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;在批处理程序中使用 FOR 命令时，指定变量请使用 %%variable而不要用 %variable。
变量名称是区分大小写的，所以 %i 不同于 %I.&lt;/p&gt;</content><category term="批处理"></category></entry></feed>