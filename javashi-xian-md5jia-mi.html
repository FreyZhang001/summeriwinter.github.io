<!DOCTYPE html>
<html lang="zh-CN">
<head>
        <title>Frey's blog : JAVA实现MD5加密</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="https://www.vhcffh.com/theme/css/main.css" type="text/css" />
        <link href="https://www.vhcffh.com/" type="application/atom+xml" rel="alternate" title="Frey's blog ATOM Feed" />

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="https://www.vhcffh.com/css/ie.css"/>
                <script src="https://www.vhcffh.com/js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="https://www.vhcffh.com/css/ie6.css"/><![endif]-->
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-111205240-3"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'UA-111205240-3');
        </script>

</head>

<body>
        
<header>
    <h1><a href="https://www.vhcffh.com/javashi-xian-md5jia-mi.html" id="page-title">JAVA实现MD5加密</a></h1>
    <span id="sitename"><a href="https://www.vhcffh.com" id="site-title">Frey's blog </a> &sdot;</span>
<time datetime="2017-07-02T10:02:00+08:00">2017-07-02</time></header>
<article>
    <p>java实现MD5加密的两种方法</p>
<p>1,调用MessageDigest实现</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.security.MessageDigest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.NoSuchAlgorithmException</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CreatMD5</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getMd5</span><span class="o">(</span><span class="n">String</span> <span class="n">plainText</span><span class="o">){</span>
        <span class="k">try</span> <span class="o">{</span>  
            <span class="n">MessageDigest</span> <span class="n">md</span> <span class="o">=</span> <span class="n">MessageDigest</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&quot;MD5&quot;</span><span class="o">);</span>  
            <span class="n">md</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">plainText</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>  
            <span class="kt">byte</span> <span class="n">b</span><span class="o">[]</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="na">digest</span><span class="o">();</span>  

            <span class="kt">int</span> <span class="n">i</span><span class="o">;</span>  

            <span class="n">StringBuffer</span> <span class="n">buf</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">);</span>  
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">offset</span> <span class="o">&lt;</span> <span class="n">b</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">offset</span><span class="o">++)</span> <span class="o">{</span>  
                <span class="n">i</span> <span class="o">=</span> <span class="n">b</span><span class="o">[</span><span class="n">offset</span><span class="o">];</span>  
                <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span>  
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">256</span><span class="o">;</span>  
                <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="o">)</span>  
                    <span class="n">buf</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;0&quot;</span><span class="o">);</span>  
                <span class="n">buf</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">toHexString</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>  
            <span class="o">}</span>  
            <span class="c1">//32位加密  </span>
            <span class="k">return</span> <span class="n">buf</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>  
            <span class="c1">// 16位的加密  </span>
            <span class="c1">//return buf.toString().substring(8, 24);  </span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">NoSuchAlgorithmException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>  
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>  
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>  
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// TODO Auto-generated method stub</span>
        <span class="n">CreatMD5</span> <span class="n">md</span><span class="o">=</span><span class="k">new</span> <span class="n">CreatMD5</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">md</span><span class="o">.</span><span class="na">getMd5</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>2,自己编写函数实现</p>
<div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CreateMD5i</span> <span class="o">{</span>

    <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">hexs</span><span class="o">[]={</span><span class="s">&quot;0&quot;</span><span class="o">,</span><span class="s">&quot;1&quot;</span><span class="o">,</span><span class="s">&quot;2&quot;</span><span class="o">,</span><span class="s">&quot;3&quot;</span><span class="o">,</span><span class="s">&quot;4&quot;</span><span class="o">,</span><span class="s">&quot;5&quot;</span><span class="o">,</span><span class="s">&quot;6&quot;</span><span class="o">,</span><span class="s">&quot;7&quot;</span><span class="o">,</span><span class="s">&quot;8&quot;</span><span class="o">,</span><span class="s">&quot;9&quot;</span><span class="o">,</span><span class="s">&quot;A&quot;</span><span class="o">,</span><span class="s">&quot;B&quot;</span><span class="o">,</span><span class="s">&quot;C&quot;</span><span class="o">,</span><span class="s">&quot;D&quot;</span><span class="o">,</span><span class="s">&quot;E&quot;</span><span class="o">,</span><span class="s">&quot;F&quot;</span><span class="o">};</span>
    <span class="c1">//标准的幻数</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">A</span><span class="o">=</span><span class="mh">0x67452301L</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">B</span><span class="o">=</span><span class="mh">0xefcdab89L</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">C</span><span class="o">=</span><span class="mh">0x98badcfeL</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">D</span><span class="o">=</span><span class="mh">0x10325476L</span><span class="o">;</span>


    <span class="c1">//下面这些S11-S44实际上是一个4*4的矩阵，在四轮循环运算中用到</span>
    <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">S11</span> <span class="o">=</span> <span class="mi">7</span><span class="o">;</span>
    <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">S12</span> <span class="o">=</span> <span class="mi">12</span><span class="o">;</span>
    <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">S13</span> <span class="o">=</span> <span class="mi">17</span><span class="o">;</span>
    <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">S14</span> <span class="o">=</span> <span class="mi">22</span><span class="o">;</span>

    <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">S21</span> <span class="o">=</span> <span class="mi">5</span><span class="o">;</span>
    <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">S22</span> <span class="o">=</span> <span class="mi">9</span><span class="o">;</span>
    <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">S23</span> <span class="o">=</span> <span class="mi">14</span><span class="o">;</span>
    <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">S24</span> <span class="o">=</span> <span class="mi">20</span><span class="o">;</span>

    <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">S31</span> <span class="o">=</span> <span class="mi">4</span><span class="o">;</span>
    <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">S32</span> <span class="o">=</span> <span class="mi">11</span><span class="o">;</span>
    <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">S33</span> <span class="o">=</span> <span class="mi">16</span><span class="o">;</span>
    <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">S34</span> <span class="o">=</span> <span class="mi">23</span><span class="o">;</span>

    <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">S41</span> <span class="o">=</span> <span class="mi">6</span><span class="o">;</span>
    <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">S42</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
    <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">S43</span> <span class="o">=</span> <span class="mi">15</span><span class="o">;</span>
    <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">S44</span> <span class="o">=</span> <span class="mi">21</span><span class="o">;</span>

    <span class="c1">//java不支持无符号的基本数据（unsigned）</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="o">[]</span> <span class="n">result</span><span class="o">={</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">};</span><span class="c1">//存储hash结果，共4×32=128位，初始化值为（幻数的级联）</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span> <span class="o">[]</span><span class="n">args</span><span class="o">){</span>
        <span class="n">CreateMD5i</span> <span class="n">md</span><span class="o">=</span><span class="k">new</span> <span class="n">CreateMD5i</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;md5(hello)=&quot;</span><span class="o">+</span><span class="n">md</span><span class="o">.</span><span class="na">digest</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">digest</span><span class="o">(</span><span class="n">String</span> <span class="n">inputStr</span><span class="o">){</span>
        <span class="kt">byte</span> <span class="o">[]</span> <span class="n">inputBytes</span><span class="o">=</span><span class="n">inputStr</span><span class="o">.</span><span class="na">getBytes</span><span class="o">();</span>
        <span class="kt">int</span> <span class="n">byteLen</span><span class="o">=</span><span class="n">inputBytes</span><span class="o">.</span><span class="na">length</span><span class="o">;</span><span class="c1">//长度（字节）</span>
        <span class="kt">int</span> <span class="n">groupCount</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="c1">//完整分组的个数</span>
        <span class="n">groupCount</span><span class="o">=</span><span class="n">byteLen</span><span class="o">/</span><span class="mi">64</span><span class="o">;</span><span class="c1">//每组512位（64字节）</span>
        <span class="kt">long</span> <span class="o">[]</span><span class="n">groups</span><span class="o">=</span><span class="kc">null</span><span class="o">;</span><span class="c1">//每个小组(64字节)再细分后的16个小组(4字节)</span>

        <span class="c1">//处理每一个完整 分组</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">step</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">step</span><span class="o">&lt;</span><span class="n">groupCount</span><span class="o">;</span><span class="n">step</span><span class="o">++){</span>
            <span class="n">groups</span><span class="o">=</span><span class="n">divGroup</span><span class="o">(</span><span class="n">inputBytes</span><span class="o">,</span><span class="n">step</span><span class="o">*</span><span class="mi">64</span><span class="o">);</span>
            <span class="n">trans</span><span class="o">(</span><span class="n">groups</span><span class="o">);</span><span class="c1">//处理分组，核心算法</span>
        <span class="o">}</span>

        <span class="c1">//处理完整分组后的尾巴</span>
        <span class="kt">int</span> <span class="n">rest</span><span class="o">=</span><span class="n">byteLen</span><span class="o">%</span><span class="mi">64</span><span class="o">;</span><span class="c1">//512位分组后的余数</span>
        <span class="kt">byte</span> <span class="o">[]</span> <span class="n">tempBytes</span><span class="o">=</span><span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">64</span><span class="o">];</span>
        <span class="k">if</span><span class="o">(</span><span class="n">rest</span><span class="o">&lt;=</span><span class="mi">56</span><span class="o">){</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">rest</span><span class="o">;</span><span class="n">i</span><span class="o">++)</span>
                <span class="n">tempBytes</span><span class="o">[</span><span class="n">i</span><span class="o">]=</span><span class="n">inputBytes</span><span class="o">[</span><span class="n">byteLen</span><span class="o">-</span><span class="n">rest</span><span class="o">+</span><span class="n">i</span><span class="o">];</span>
            <span class="k">if</span><span class="o">(</span><span class="n">rest</span><span class="o">&lt;</span><span class="mi">56</span><span class="o">){</span>
                <span class="n">tempBytes</span><span class="o">[</span><span class="n">rest</span><span class="o">]=(</span><span class="kt">byte</span><span class="o">)(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">7</span><span class="o">);</span>
                <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">56</span><span class="o">-</span><span class="n">rest</span><span class="o">;</span><span class="n">i</span><span class="o">++)</span>
                    <span class="n">tempBytes</span><span class="o">[</span><span class="n">rest</span><span class="o">+</span><span class="n">i</span><span class="o">]=</span><span class="mi">0</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="kt">long</span> <span class="n">len</span><span class="o">=(</span><span class="kt">long</span><span class="o">)(</span><span class="n">byteLen</span><span class="o">&lt;&lt;</span><span class="mi">3</span><span class="o">);</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">8</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
                <span class="n">tempBytes</span><span class="o">[</span><span class="mi">56</span><span class="o">+</span><span class="n">i</span><span class="o">]=(</span><span class="kt">byte</span><span class="o">)(</span><span class="n">len</span><span class="o">&amp;</span><span class="mh">0xFFL</span><span class="o">);</span>
                <span class="n">len</span><span class="o">=</span><span class="n">len</span><span class="o">&gt;&gt;</span><span class="mi">8</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">groups</span><span class="o">=</span><span class="n">divGroup</span><span class="o">(</span><span class="n">tempBytes</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>
            <span class="n">trans</span><span class="o">(</span><span class="n">groups</span><span class="o">);</span><span class="c1">//处理分组</span>
        <span class="o">}</span><span class="k">else</span><span class="o">{</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">rest</span><span class="o">;</span><span class="n">i</span><span class="o">++)</span>
                <span class="n">tempBytes</span><span class="o">[</span><span class="n">i</span><span class="o">]=</span><span class="n">inputBytes</span><span class="o">[</span><span class="n">byteLen</span><span class="o">-</span><span class="n">rest</span><span class="o">+</span><span class="n">i</span><span class="o">];</span>
            <span class="n">tempBytes</span><span class="o">[</span><span class="n">rest</span><span class="o">]=(</span><span class="kt">byte</span><span class="o">)(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">7</span><span class="o">);</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">rest</span><span class="o">+</span><span class="mi">1</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">64</span><span class="o">;</span><span class="n">i</span><span class="o">++)</span>
                <span class="n">tempBytes</span><span class="o">[</span><span class="n">i</span><span class="o">]=</span><span class="mi">0</span><span class="o">;</span>
            <span class="n">groups</span><span class="o">=</span><span class="n">divGroup</span><span class="o">(</span><span class="n">tempBytes</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>
            <span class="n">trans</span><span class="o">(</span><span class="n">groups</span><span class="o">);</span><span class="c1">//处理分组</span>

            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">56</span><span class="o">;</span><span class="n">i</span><span class="o">++)</span>
                <span class="n">tempBytes</span><span class="o">[</span><span class="n">i</span><span class="o">]=</span><span class="mi">0</span><span class="o">;</span>
            <span class="kt">long</span> <span class="n">len</span><span class="o">=(</span><span class="kt">long</span><span class="o">)(</span><span class="n">byteLen</span><span class="o">&lt;&lt;</span><span class="mi">3</span><span class="o">);</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">8</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
                <span class="n">tempBytes</span><span class="o">[</span><span class="mi">56</span><span class="o">+</span><span class="n">i</span><span class="o">]=(</span><span class="kt">byte</span><span class="o">)(</span><span class="n">len</span><span class="o">&amp;</span><span class="mh">0xFFL</span><span class="o">);</span>
                <span class="n">len</span><span class="o">=</span><span class="n">len</span><span class="o">&gt;&gt;</span><span class="mi">8</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">groups</span><span class="o">=</span><span class="n">divGroup</span><span class="o">(</span><span class="n">tempBytes</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>
            <span class="n">trans</span><span class="o">(</span><span class="n">groups</span><span class="o">);</span><span class="c1">//处理分组</span>
        <span class="o">}</span>

        <span class="c1">//将Hash值转换成十六进制的字符串</span>
        <span class="n">String</span> <span class="n">resStr</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="kt">long</span> <span class="n">temp</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">4</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">4</span><span class="o">;</span><span class="n">j</span><span class="o">++){</span>
                <span class="n">temp</span><span class="o">=</span><span class="n">result</span><span class="o">[</span><span class="n">i</span><span class="o">]&amp;</span><span class="mh">0x0FL</span><span class="o">;</span>
                <span class="n">String</span> <span class="n">a</span><span class="o">=</span><span class="n">hexs</span><span class="o">[(</span><span class="kt">int</span><span class="o">)(</span><span class="n">temp</span><span class="o">)];</span>
                <span class="n">result</span><span class="o">[</span><span class="n">i</span><span class="o">]=</span><span class="n">result</span><span class="o">[</span><span class="n">i</span><span class="o">]&gt;&gt;</span><span class="mi">4</span><span class="o">;</span>
                <span class="n">temp</span><span class="o">=</span><span class="n">result</span><span class="o">[</span><span class="n">i</span><span class="o">]&amp;</span><span class="mh">0x0FL</span><span class="o">;</span>
                <span class="n">resStr</span><span class="o">+=</span><span class="n">hexs</span><span class="o">[(</span><span class="kt">int</span><span class="o">)(</span><span class="n">temp</span><span class="o">)]+</span><span class="n">a</span><span class="o">;</span>
                <span class="n">result</span><span class="o">[</span><span class="n">i</span><span class="o">]=</span><span class="n">result</span><span class="o">[</span><span class="n">i</span><span class="o">]&gt;&gt;</span><span class="mi">4</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">resStr</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * 从inputBytes的index开始取512位，作为新的分组</span>
<span class="cm">     * 将每一个512位的分组再细分成16个小组，每个小组64位（8个字节）</span>
<span class="cm">     * @param inputBytes</span>
<span class="cm">     * @param index</span>
<span class="cm">     * @return</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span><span class="o">[]</span> <span class="nf">divGroup</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">inputBytes</span><span class="o">,</span><span class="kt">int</span> <span class="n">index</span><span class="o">){</span>
        <span class="kt">long</span> <span class="o">[]</span> <span class="n">temp</span><span class="o">=</span><span class="k">new</span> <span class="kt">long</span><span class="o">[</span><span class="mi">16</span><span class="o">];</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">16</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
            <span class="n">temp</span><span class="o">[</span><span class="n">i</span><span class="o">]=</span><span class="n">b2iu</span><span class="o">(</span><span class="n">inputBytes</span><span class="o">[</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">index</span><span class="o">])|</span>
                <span class="o">(</span><span class="n">b2iu</span><span class="o">(</span><span class="n">inputBytes</span><span class="o">[</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">index</span><span class="o">]))&lt;&lt;</span><span class="mi">8</span><span class="o">|</span>
                <span class="o">(</span><span class="n">b2iu</span><span class="o">(</span><span class="n">inputBytes</span><span class="o">[</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">index</span><span class="o">]))&lt;&lt;</span><span class="mi">16</span><span class="o">|</span>
                <span class="o">(</span><span class="n">b2iu</span><span class="o">(</span><span class="n">inputBytes</span><span class="o">[</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="n">index</span><span class="o">]))&lt;&lt;</span><span class="mi">24</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">temp</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * 这时不存在符号位（符号位存储不再是代表正负），所以需要处理一下</span>
<span class="cm">     * @param b</span>
<span class="cm">     * @return</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">b2iu</span><span class="o">(</span><span class="kt">byte</span> <span class="n">b</span><span class="o">){</span>
        <span class="k">return</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="n">b</span> <span class="o">&amp;</span> <span class="mh">0x7F</span> <span class="o">+</span> <span class="mi">128</span> <span class="o">:</span> <span class="n">b</span><span class="o">;</span>
     <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * 主要的操作，四轮循环</span>
<span class="cm">     * @param groups[]--每一个分组512位（64字节）</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">trans</span><span class="o">(</span><span class="kt">long</span><span class="o">[]</span> <span class="n">groups</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">long</span> <span class="n">a</span> <span class="o">=</span> <span class="n">result</span><span class="o">[</span><span class="mi">0</span><span class="o">],</span> <span class="n">b</span> <span class="o">=</span> <span class="n">result</span><span class="o">[</span><span class="mi">1</span><span class="o">],</span> <span class="n">c</span> <span class="o">=</span> <span class="n">result</span><span class="o">[</span><span class="mi">2</span><span class="o">],</span> <span class="n">d</span> <span class="o">=</span> <span class="n">result</span><span class="o">[</span><span class="mi">3</span><span class="o">];</span>
        <span class="cm">/*第一轮*/</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">FF</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">0</span><span class="o">],</span> <span class="n">S11</span><span class="o">,</span> <span class="mh">0xd76aa478L</span><span class="o">);</span> <span class="cm">/* 1 */</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">FF</span><span class="o">(</span><span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">1</span><span class="o">],</span> <span class="n">S12</span><span class="o">,</span> <span class="mh">0xe8c7b756L</span><span class="o">);</span> <span class="cm">/* 2 */</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">FF</span><span class="o">(</span><span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">2</span><span class="o">],</span> <span class="n">S13</span><span class="o">,</span> <span class="mh">0x242070dbL</span><span class="o">);</span> <span class="cm">/* 3 */</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">FF</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">3</span><span class="o">],</span> <span class="n">S14</span><span class="o">,</span> <span class="mh">0xc1bdceeeL</span><span class="o">);</span> <span class="cm">/* 4 */</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">FF</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">4</span><span class="o">],</span> <span class="n">S11</span><span class="o">,</span> <span class="mh">0xf57c0fafL</span><span class="o">);</span> <span class="cm">/* 5 */</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">FF</span><span class="o">(</span><span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">5</span><span class="o">],</span> <span class="n">S12</span><span class="o">,</span> <span class="mh">0x4787c62aL</span><span class="o">);</span> <span class="cm">/* 6 */</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">FF</span><span class="o">(</span><span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">6</span><span class="o">],</span> <span class="n">S13</span><span class="o">,</span> <span class="mh">0xa8304613L</span><span class="o">);</span> <span class="cm">/* 7 */</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">FF</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">7</span><span class="o">],</span> <span class="n">S14</span><span class="o">,</span> <span class="mh">0xfd469501L</span><span class="o">);</span> <span class="cm">/* 8 */</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">FF</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">8</span><span class="o">],</span> <span class="n">S11</span><span class="o">,</span> <span class="mh">0x698098d8L</span><span class="o">);</span> <span class="cm">/* 9 */</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">FF</span><span class="o">(</span><span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">9</span><span class="o">],</span> <span class="n">S12</span><span class="o">,</span> <span class="mh">0x8b44f7afL</span><span class="o">);</span> <span class="cm">/* 10 */</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">FF</span><span class="o">(</span><span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">10</span><span class="o">],</span> <span class="n">S13</span><span class="o">,</span> <span class="mh">0xffff5bb1L</span><span class="o">);</span> <span class="cm">/* 11 */</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">FF</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">11</span><span class="o">],</span> <span class="n">S14</span><span class="o">,</span> <span class="mh">0x895cd7beL</span><span class="o">);</span> <span class="cm">/* 12 */</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">FF</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">12</span><span class="o">],</span> <span class="n">S11</span><span class="o">,</span> <span class="mh">0x6b901122L</span><span class="o">);</span> <span class="cm">/* 13 */</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">FF</span><span class="o">(</span><span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">13</span><span class="o">],</span> <span class="n">S12</span><span class="o">,</span> <span class="mh">0xfd987193L</span><span class="o">);</span> <span class="cm">/* 14 */</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">FF</span><span class="o">(</span><span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">14</span><span class="o">],</span> <span class="n">S13</span><span class="o">,</span> <span class="mh">0xa679438eL</span><span class="o">);</span> <span class="cm">/* 15 */</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">FF</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">15</span><span class="o">],</span> <span class="n">S14</span><span class="o">,</span> <span class="mh">0x49b40821L</span><span class="o">);</span> <span class="cm">/* 16 */</span>

        <span class="cm">/*第二轮*/</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">GG</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">1</span><span class="o">],</span> <span class="n">S21</span><span class="o">,</span> <span class="mh">0xf61e2562L</span><span class="o">);</span> <span class="cm">/* 17 */</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">GG</span><span class="o">(</span><span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">6</span><span class="o">],</span> <span class="n">S22</span><span class="o">,</span> <span class="mh">0xc040b340L</span><span class="o">);</span> <span class="cm">/* 18 */</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">GG</span><span class="o">(</span><span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">11</span><span class="o">],</span> <span class="n">S23</span><span class="o">,</span> <span class="mh">0x265e5a51L</span><span class="o">);</span> <span class="cm">/* 19 */</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">GG</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">0</span><span class="o">],</span> <span class="n">S24</span><span class="o">,</span> <span class="mh">0xe9b6c7aaL</span><span class="o">);</span> <span class="cm">/* 20 */</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">GG</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">5</span><span class="o">],</span> <span class="n">S21</span><span class="o">,</span> <span class="mh">0xd62f105dL</span><span class="o">);</span> <span class="cm">/* 21 */</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">GG</span><span class="o">(</span><span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">10</span><span class="o">],</span> <span class="n">S22</span><span class="o">,</span> <span class="mh">0x2441453L</span><span class="o">);</span> <span class="cm">/* 22 */</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">GG</span><span class="o">(</span><span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">15</span><span class="o">],</span> <span class="n">S23</span><span class="o">,</span> <span class="mh">0xd8a1e681L</span><span class="o">);</span> <span class="cm">/* 23 */</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">GG</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">4</span><span class="o">],</span> <span class="n">S24</span><span class="o">,</span> <span class="mh">0xe7d3fbc8L</span><span class="o">);</span> <span class="cm">/* 24 */</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">GG</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">9</span><span class="o">],</span> <span class="n">S21</span><span class="o">,</span> <span class="mh">0x21e1cde6L</span><span class="o">);</span> <span class="cm">/* 25 */</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">GG</span><span class="o">(</span><span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">14</span><span class="o">],</span> <span class="n">S22</span><span class="o">,</span> <span class="mh">0xc33707d6L</span><span class="o">);</span> <span class="cm">/* 26 */</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">GG</span><span class="o">(</span><span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">3</span><span class="o">],</span> <span class="n">S23</span><span class="o">,</span> <span class="mh">0xf4d50d87L</span><span class="o">);</span> <span class="cm">/* 27 */</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">GG</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">8</span><span class="o">],</span> <span class="n">S24</span><span class="o">,</span> <span class="mh">0x455a14edL</span><span class="o">);</span> <span class="cm">/* 28 */</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">GG</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">13</span><span class="o">],</span> <span class="n">S21</span><span class="o">,</span> <span class="mh">0xa9e3e905L</span><span class="o">);</span> <span class="cm">/* 29 */</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">GG</span><span class="o">(</span><span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">2</span><span class="o">],</span> <span class="n">S22</span><span class="o">,</span> <span class="mh">0xfcefa3f8L</span><span class="o">);</span> <span class="cm">/* 30 */</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">GG</span><span class="o">(</span><span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">7</span><span class="o">],</span> <span class="n">S23</span><span class="o">,</span> <span class="mh">0x676f02d9L</span><span class="o">);</span> <span class="cm">/* 31 */</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">GG</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">12</span><span class="o">],</span> <span class="n">S24</span><span class="o">,</span> <span class="mh">0x8d2a4c8aL</span><span class="o">);</span> <span class="cm">/* 32 */</span>

        <span class="cm">/*第三轮*/</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">HH</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">5</span><span class="o">],</span> <span class="n">S31</span><span class="o">,</span> <span class="mh">0xfffa3942L</span><span class="o">);</span> <span class="cm">/* 33 */</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">HH</span><span class="o">(</span><span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">8</span><span class="o">],</span> <span class="n">S32</span><span class="o">,</span> <span class="mh">0x8771f681L</span><span class="o">);</span> <span class="cm">/* 34 */</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">HH</span><span class="o">(</span><span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">11</span><span class="o">],</span> <span class="n">S33</span><span class="o">,</span> <span class="mh">0x6d9d6122L</span><span class="o">);</span> <span class="cm">/* 35 */</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">HH</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">14</span><span class="o">],</span> <span class="n">S34</span><span class="o">,</span> <span class="mh">0xfde5380cL</span><span class="o">);</span> <span class="cm">/* 36 */</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">HH</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">1</span><span class="o">],</span> <span class="n">S31</span><span class="o">,</span> <span class="mh">0xa4beea44L</span><span class="o">);</span> <span class="cm">/* 37 */</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">HH</span><span class="o">(</span><span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">4</span><span class="o">],</span> <span class="n">S32</span><span class="o">,</span> <span class="mh">0x4bdecfa9L</span><span class="o">);</span> <span class="cm">/* 38 */</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">HH</span><span class="o">(</span><span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">7</span><span class="o">],</span> <span class="n">S33</span><span class="o">,</span> <span class="mh">0xf6bb4b60L</span><span class="o">);</span> <span class="cm">/* 39 */</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">HH</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">10</span><span class="o">],</span> <span class="n">S34</span><span class="o">,</span> <span class="mh">0xbebfbc70L</span><span class="o">);</span> <span class="cm">/* 40 */</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">HH</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">13</span><span class="o">],</span> <span class="n">S31</span><span class="o">,</span> <span class="mh">0x289b7ec6L</span><span class="o">);</span> <span class="cm">/* 41 */</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">HH</span><span class="o">(</span><span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">0</span><span class="o">],</span> <span class="n">S32</span><span class="o">,</span> <span class="mh">0xeaa127faL</span><span class="o">);</span> <span class="cm">/* 42 */</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">HH</span><span class="o">(</span><span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">3</span><span class="o">],</span> <span class="n">S33</span><span class="o">,</span> <span class="mh">0xd4ef3085L</span><span class="o">);</span> <span class="cm">/* 43 */</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">HH</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">6</span><span class="o">],</span> <span class="n">S34</span><span class="o">,</span> <span class="mh">0x4881d05L</span><span class="o">);</span> <span class="cm">/* 44 */</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">HH</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">9</span><span class="o">],</span> <span class="n">S31</span><span class="o">,</span> <span class="mh">0xd9d4d039L</span><span class="o">);</span> <span class="cm">/* 45 */</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">HH</span><span class="o">(</span><span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">12</span><span class="o">],</span> <span class="n">S32</span><span class="o">,</span> <span class="mh">0xe6db99e5L</span><span class="o">);</span> <span class="cm">/* 46 */</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">HH</span><span class="o">(</span><span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">15</span><span class="o">],</span> <span class="n">S33</span><span class="o">,</span> <span class="mh">0x1fa27cf8L</span><span class="o">);</span> <span class="cm">/* 47 */</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">HH</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">2</span><span class="o">],</span> <span class="n">S34</span><span class="o">,</span> <span class="mh">0xc4ac5665L</span><span class="o">);</span> <span class="cm">/* 48 */</span>

        <span class="cm">/*第四轮*/</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">II</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">0</span><span class="o">],</span> <span class="n">S41</span><span class="o">,</span> <span class="mh">0xf4292244L</span><span class="o">);</span> <span class="cm">/* 49 */</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">II</span><span class="o">(</span><span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">7</span><span class="o">],</span> <span class="n">S42</span><span class="o">,</span> <span class="mh">0x432aff97L</span><span class="o">);</span> <span class="cm">/* 50 */</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">II</span><span class="o">(</span><span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">14</span><span class="o">],</span> <span class="n">S43</span><span class="o">,</span> <span class="mh">0xab9423a7L</span><span class="o">);</span> <span class="cm">/* 51 */</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">II</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">5</span><span class="o">],</span> <span class="n">S44</span><span class="o">,</span> <span class="mh">0xfc93a039L</span><span class="o">);</span> <span class="cm">/* 52 */</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">II</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">12</span><span class="o">],</span> <span class="n">S41</span><span class="o">,</span> <span class="mh">0x655b59c3L</span><span class="o">);</span> <span class="cm">/* 53 */</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">II</span><span class="o">(</span><span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">3</span><span class="o">],</span> <span class="n">S42</span><span class="o">,</span> <span class="mh">0x8f0ccc92L</span><span class="o">);</span> <span class="cm">/* 54 */</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">II</span><span class="o">(</span><span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">10</span><span class="o">],</span> <span class="n">S43</span><span class="o">,</span> <span class="mh">0xffeff47dL</span><span class="o">);</span> <span class="cm">/* 55 */</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">II</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">1</span><span class="o">],</span> <span class="n">S44</span><span class="o">,</span> <span class="mh">0x85845dd1L</span><span class="o">);</span> <span class="cm">/* 56 */</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">II</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">8</span><span class="o">],</span> <span class="n">S41</span><span class="o">,</span> <span class="mh">0x6fa87e4fL</span><span class="o">);</span> <span class="cm">/* 57 */</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">II</span><span class="o">(</span><span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">15</span><span class="o">],</span> <span class="n">S42</span><span class="o">,</span> <span class="mh">0xfe2ce6e0L</span><span class="o">);</span> <span class="cm">/* 58 */</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">II</span><span class="o">(</span><span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">6</span><span class="o">],</span> <span class="n">S43</span><span class="o">,</span> <span class="mh">0xa3014314L</span><span class="o">);</span> <span class="cm">/* 59 */</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">II</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">13</span><span class="o">],</span> <span class="n">S44</span><span class="o">,</span> <span class="mh">0x4e0811a1L</span><span class="o">);</span> <span class="cm">/* 60 */</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">II</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">4</span><span class="o">],</span> <span class="n">S41</span><span class="o">,</span> <span class="mh">0xf7537e82L</span><span class="o">);</span> <span class="cm">/* 61 */</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">II</span><span class="o">(</span><span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">11</span><span class="o">],</span> <span class="n">S42</span><span class="o">,</span> <span class="mh">0xbd3af235L</span><span class="o">);</span> <span class="cm">/* 62 */</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">II</span><span class="o">(</span><span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">2</span><span class="o">],</span> <span class="n">S43</span><span class="o">,</span> <span class="mh">0x2ad7d2bbL</span><span class="o">);</span> <span class="cm">/* 63 */</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">II</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">groups</span><span class="o">[</span><span class="mi">9</span><span class="o">],</span> <span class="n">S44</span><span class="o">,</span> <span class="mh">0xeb86d391L</span><span class="o">);</span> <span class="cm">/* 64 */</span>

        <span class="cm">/*加入到之前计算的结果当中*/</span>
        <span class="n">result</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">+=</span> <span class="n">a</span><span class="o">;</span>
        <span class="n">result</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">+=</span> <span class="n">b</span><span class="o">;</span>
        <span class="n">result</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">+=</span> <span class="n">c</span><span class="o">;</span>
        <span class="n">result</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span> <span class="o">+=</span> <span class="n">d</span><span class="o">;</span>
        <span class="n">result</span><span class="o">[</span><span class="mi">0</span><span class="o">]=</span><span class="n">result</span><span class="o">[</span><span class="mi">0</span><span class="o">]&amp;</span><span class="mh">0xFFFFFFFFL</span><span class="o">;</span>
        <span class="n">result</span><span class="o">[</span><span class="mi">1</span><span class="o">]=</span><span class="n">result</span><span class="o">[</span><span class="mi">1</span><span class="o">]&amp;</span><span class="mh">0xFFFFFFFFL</span><span class="o">;</span>
        <span class="n">result</span><span class="o">[</span><span class="mi">2</span><span class="o">]=</span><span class="n">result</span><span class="o">[</span><span class="mi">2</span><span class="o">]&amp;</span><span class="mh">0xFFFFFFFFL</span><span class="o">;</span>
        <span class="n">result</span><span class="o">[</span><span class="mi">3</span><span class="o">]=</span><span class="n">result</span><span class="o">[</span><span class="mi">3</span><span class="o">]&amp;</span><span class="mh">0xFFFFFFFFL</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * 下面是处理要用到的线性函数</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">F</span><span class="o">(</span><span class="kt">long</span> <span class="n">x</span><span class="o">,</span> <span class="kt">long</span> <span class="n">y</span><span class="o">,</span> <span class="kt">long</span> <span class="n">z</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span><span class="o">)</span> <span class="o">|</span> <span class="o">((~</span><span class="n">x</span><span class="o">)</span> <span class="o">&amp;</span> <span class="n">z</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">G</span><span class="o">(</span><span class="kt">long</span> <span class="n">x</span><span class="o">,</span> <span class="kt">long</span> <span class="n">y</span><span class="o">,</span> <span class="kt">long</span> <span class="n">z</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">z</span><span class="o">)</span> <span class="o">|</span> <span class="o">(</span><span class="n">y</span> <span class="o">&amp;</span> <span class="o">(~</span><span class="n">z</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">H</span><span class="o">(</span><span class="kt">long</span> <span class="n">x</span><span class="o">,</span> <span class="kt">long</span> <span class="n">y</span><span class="o">,</span> <span class="kt">long</span> <span class="n">z</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">^</span> <span class="n">y</span> <span class="o">^</span> <span class="n">z</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">I</span><span class="o">(</span><span class="kt">long</span> <span class="n">x</span><span class="o">,</span> <span class="kt">long</span> <span class="n">y</span><span class="o">,</span> <span class="kt">long</span> <span class="n">z</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">y</span> <span class="o">^</span> <span class="o">(</span><span class="n">x</span> <span class="o">|</span> <span class="o">(~</span><span class="n">z</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">FF</span><span class="o">(</span><span class="kt">long</span> <span class="n">a</span><span class="o">,</span> <span class="kt">long</span> <span class="n">b</span><span class="o">,</span> <span class="kt">long</span> <span class="n">c</span><span class="o">,</span> <span class="kt">long</span> <span class="n">d</span><span class="o">,</span> <span class="kt">long</span> <span class="n">x</span><span class="o">,</span> <span class="kt">long</span> <span class="n">s</span><span class="o">,</span>
            <span class="kt">long</span> <span class="n">ac</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="o">(</span><span class="n">F</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">)&amp;</span><span class="mh">0xFFFFFFFFL</span><span class="o">)</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">ac</span><span class="o">;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="o">((</span><span class="n">a</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFFL</span><span class="o">)&lt;&lt;</span> <span class="n">s</span><span class="o">)</span> <span class="o">|</span> <span class="o">((</span><span class="n">a</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFFL</span><span class="o">)</span> <span class="o">&gt;&gt;&gt;</span> <span class="o">(</span><span class="mi">32</span> <span class="o">-</span> <span class="n">s</span><span class="o">));</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="n">b</span><span class="o">;</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">a</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFFL</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">GG</span><span class="o">(</span><span class="kt">long</span> <span class="n">a</span><span class="o">,</span> <span class="kt">long</span> <span class="n">b</span><span class="o">,</span> <span class="kt">long</span> <span class="n">c</span><span class="o">,</span> <span class="kt">long</span> <span class="n">d</span><span class="o">,</span> <span class="kt">long</span> <span class="n">x</span><span class="o">,</span> <span class="kt">long</span> <span class="n">s</span><span class="o">,</span>
            <span class="kt">long</span> <span class="n">ac</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="o">(</span><span class="n">G</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">)&amp;</span><span class="mh">0xFFFFFFFFL</span><span class="o">)</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">ac</span><span class="o">;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="o">((</span><span class="n">a</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFFL</span><span class="o">)</span> <span class="o">&lt;&lt;</span> <span class="n">s</span><span class="o">)</span> <span class="o">|</span> <span class="o">((</span><span class="n">a</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFFL</span><span class="o">)</span> <span class="o">&gt;&gt;&gt;</span> <span class="o">(</span><span class="mi">32</span> <span class="o">-</span> <span class="n">s</span><span class="o">));</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="n">b</span><span class="o">;</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">a</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFFL</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">HH</span><span class="o">(</span><span class="kt">long</span> <span class="n">a</span><span class="o">,</span> <span class="kt">long</span> <span class="n">b</span><span class="o">,</span> <span class="kt">long</span> <span class="n">c</span><span class="o">,</span> <span class="kt">long</span> <span class="n">d</span><span class="o">,</span> <span class="kt">long</span> <span class="n">x</span><span class="o">,</span> <span class="kt">long</span> <span class="n">s</span><span class="o">,</span>
            <span class="kt">long</span> <span class="n">ac</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="o">(</span><span class="n">H</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">)&amp;</span><span class="mh">0xFFFFFFFFL</span><span class="o">)</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">ac</span><span class="o">;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="o">((</span><span class="n">a</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFFL</span><span class="o">)</span> <span class="o">&lt;&lt;</span> <span class="n">s</span><span class="o">)</span> <span class="o">|</span> <span class="o">((</span><span class="n">a</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFFL</span><span class="o">)</span> <span class="o">&gt;&gt;&gt;</span> <span class="o">(</span><span class="mi">32</span> <span class="o">-</span> <span class="n">s</span><span class="o">));</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="n">b</span><span class="o">;</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">a</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFFL</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">II</span><span class="o">(</span><span class="kt">long</span> <span class="n">a</span><span class="o">,</span> <span class="kt">long</span> <span class="n">b</span><span class="o">,</span> <span class="kt">long</span> <span class="n">c</span><span class="o">,</span> <span class="kt">long</span> <span class="n">d</span><span class="o">,</span> <span class="kt">long</span> <span class="n">x</span><span class="o">,</span> <span class="kt">long</span> <span class="n">s</span><span class="o">,</span>
            <span class="kt">long</span> <span class="n">ac</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="o">(</span><span class="n">I</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">)&amp;</span><span class="mh">0xFFFFFFFFL</span><span class="o">)</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">ac</span><span class="o">;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="o">((</span><span class="n">a</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFFL</span><span class="o">)</span> <span class="o">&lt;&lt;</span> <span class="n">s</span><span class="o">)</span> <span class="o">|</span> <span class="o">((</span><span class="n">a</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFFL</span><span class="o">)</span> <span class="o">&gt;&gt;&gt;</span> <span class="o">(</span><span class="mi">32</span> <span class="o">-</span> <span class="n">s</span><span class="o">));</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="n">b</span><span class="o">;</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">a</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFFL</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</article>



</body>
</html>